<!DOCTYPE html>
<html>
    <head>
    <title>ReCouver</title>
    <!-- font -->
    <link href="https://fonts.googleapis.com/css?family=Poppins" rel="stylesheet">
    <!-- bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
    <!-- maps -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css"
    integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
    crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"
    integrity="sha512-GffPMF3RvMeYyc1LWMHtK8EbPv0iNZ8/oTtHPx9/cc2ILxQ+u905qIwdpULaqDkyBKgOaB57QTMg7ztg8Jm2Og=="
    crossorigin=""></script>
    <!-- CSS sheet -->
    <link rel="stylesheet" type="text/css" href="../css/a.css">
    </head>

    <body>

        <nav id="navbar">

        </nav>
        <div id="container">
			<div>
                <button class="green button" onclick="exp()">I did this!</button>
                <p class="activityTitle">Neighbourhood Cleanup Party</p>
                <p class="activityDate">Saturday, May 25, 2019 - 10:00am - 12:00pm</p>
                <p class="activityDate">Strathcona Community Policing Centre</p>
                <p class="activityDate">Register: <a href="https://vancouver.ca/news-calendar/calendar-of-events.aspx?trumbaEmbed=eventid%3D131832782%26view%3Devent%26-childview%3D">Click here</a></p>
            </div>
            <hr>
            <div class="row">
                <div class="col-sm-6">
                    <p class="description">This neighbourhood cleanup Party
                    is hosted by Zero Waste and Resource Recovery along with the City of Vancouver.
                    Do your part to clean up littered items around the Strathcona area. Make sure to
                    keep your eyes out for recyclables and items that can be reused!
                    <p class="description">If you want to register, click <a href="https://vancouver.ca/news-calendar/calendar-of-events.aspx?trumbaEmbed=eventid%3D131832782%26view%3Devent%26-childview%3D">here</a> for more info.
                    </p>
                    </p>
                </div>
                <div class="col-sm-6">
                    <div id="map">
                        <script>
                            var mymap = L.map('map').setView([49.281003, -123.085564], 16);
                            var marker = L.marker([49.281003, -123.085564]).addTo(mymap);
                            marker.bindPopup("<b>Strathcona Community Policing Centre</b><br>872 E Hastings St, Vancouver, BC V6A 1R6").openPopup();

                            L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiYnJ5Y2UxMjM0NSIsImEiOiJjanZoMmxvejYwZTNsNDhyZ2w2M2NoNG9rIn0.xyyjfXZ4egW9hJGX0lu5Cw', {
                                attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
                                maxZoom: 18,
                                id: 'mapbox.streets',
                                accessToken: 'your.mapbox.access.token'
                            }).addTo(mymap);             
                        </script>
                    </div>
                    <!--img class="divImg" src="../images/neighbourhoodcleanup2.jpg">
                    <p class="credit">Credit: <a href="http://flickrhivemind.net/User/Rod%20Raglin#Tags">Rod Raglin</a></p-->
                </div>
            </div>
            </p>
         </div> <!-- container --> 

            <!-- Modal for user not being signed in -->
            <div class="modal fade" id="NoUserModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">No account detected.</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    </div>
                    <div class="modal-body">
                    Clicking this button would usually earn you EXP points towards your EnviroLevel. <br>
                    To gain EXP, you need to create an account.
                    </div>
                    <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" onclick="window.location.href = '../activities.html';">Sign up</button>
                    </div>
                </div>
                </div>
            </div>

         <script src="https://www.gstatic.com/firebasejs/5.5.6/firebase.js"></script>
         <script>
         var firebaseConfig = {
           apiKey: "AIzaSyArizlf6ZrRg4AHuhDAut2wUY7EyDnX6s4",
           authDomain: "recouver-ac06e.firebaseapp.com",
           databaseURL: "https://recouver-ac06e.firebaseio.com",
           projectId: "recouver-ac06e",
           storageBucket: "recouver-ac06e.appspot.com",
           messagingSenderId: "1095105070905",
           appId: "1:1095105070905:web:dd71f6c8856cc6df"
         };
         firebase.initializeApp(firebaseConfig);
         </script>

         <script>
            var clicked = false;
            var fb = firebase.database();
            var xpValue;
            var user = firebase.auth().currentUser;

            function exp() {
                if (user) {
                    var exp = 3;
                    if (clicked) {
                        window.alert("You've already gained exp for that.")
                    }
                    if (!clicked) {
                        fb.ref('Users/user1/xp').once('value', function(snapshot) {
                            xpValue = snapshot.val();
                        }).then(function() {
                        fb.ref("Users/user1").update({ xp: xpValue +3 });
                        window.alert("You've gained "+exp+" EXP!");
                        clicked = true;
                        });
                    }
                } else {
                    $('#NoUserModal').modal('show');
                    //window.alert("You need to create an account to earn exp!");
                }
            }
         </script>

    </body>
</html>